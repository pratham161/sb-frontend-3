---
---

<section id="blog" class="bg-linear-to-b from-black to-gray-900 text-white py-16 px-6">
	<div class="max-w-7xl mx-auto">
		<!-- Section Title -->
		<div class="mb-12">
			<h2 class="text-3xl md:text-4xl font-extrabold mb-2 text-red-500">Latest Blog Posts</h2>
			<div class="w-16 h-1 bg-green-500 rounded"></div>
		</div>

		<!-- Carousel Container -->
		<div class="relative">
			<!-- Blog Cards Carousel -->
			<div class="overflow-hidden rounded-xl">
				<div id="carousel" class="flex transition-transform duration-500 ease-out">
					<!-- Blog Card 1 -->
					<div class="carousel-card min-w-full md:min-w-1/3 lg:min-w-1/4 px-3">
						<a href=" /Article">
						<div class="bg-gray-800/50 backdrop-blur-sm border border-green-500/30 rounded-lg overflow-hidden hover:border-green-400/60 hover:bg-gray-800/70 transition-all duration-200 h-full">
							<div class="w-full h-48 bg-linear-to-br from-green-600 to-green-800 flex items-center justify-center overflow-hidden">
								<img src="https://picsum.photos/400/300?random=10" alt="Blog Post" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" />
							</div>
							<div class="p-6">
								<p class="text-xs text-green-400 font-semibold mb-2">SPIRULINA BENEFITS</p>
								<h3 class="text-lg font-bold mb-3 text-yellow-400 line-clamp-2">The Ultimate Guide to Spirulina Nutrition</h3>
								<p class="text-sm text-white line-clamp-3">Discover the amazing health benefits of spirulina and how it can transform your wellness journey with natural nutrients.</p>
								<a href="#" class="inline-block mt-4 text-green-400 hover:text-green-300 font-semibold text-sm transition-colors">Read More →</a>
							</div>
						</div>
						</a>
					</div>

					<!-- Blog Card 2 -->
					<div class="carousel-card min-w-full md:min-w-1/3 lg:min-w-1/4 px-3">
						<div class="bg-gray-800/50 backdrop-blur-sm border border-green-500/30 rounded-lg overflow-hidden hover:border-green-400/60 hover:bg-gray-800/70 transition-all duration-200 h-full">
							<div class="w-full h-48 bg-linear-to-br from-green-600 to-green-800 flex items-center justify-center overflow-hidden">
								<img src="https://picsum.photos/400/300?random=11" alt="Blog Post" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" />
							</div>
							<div class="p-6">
								<p class="text-xs text-green-400 font-semibold mb-2">HEALTHY LIVING</p>
								<h3 class="text-lg font-bold mb-3 text-yellow-400 line-clamp-2">5 Ways to Incorporate Spirulina in Your Diet</h3>
								<p class="text-sm text-white line-clamp-3">Easy and delicious recipes to add spirulina to your daily meals for maximum health benefits and nutrition.</p>
								<a href="#" class="inline-block mt-4 text-green-400 hover:text-green-300 font-semibold text-sm transition-colors">Read More →</a>
							</div>
						</div>
					</div>

					<!-- Blog Card 3 -->
					<div class="carousel-card min-w-full md:min-w-1/3 lg:min-w-1/4 px-3">
						<div class="bg-gray-800/50 backdrop-blur-sm border border-green-500/30 rounded-lg overflow-hidden hover:border-green-400/60 hover:bg-gray-800/70 transition-all duration-200 h-full">
							<div class="w-full h-48 bg-linear-to-br from-green-600 to-green-800 flex items-center justify-center overflow-hidden">
								<img src="https://picsum.photos/400/300?random=12" alt="Blog Post" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" />
							</div>
							<div class="p-6">
								<p class="text-xs text-green-400 font-semibold mb-2">SUSTAINABILITY</p>
								<h3 class="text-lg font-bold mb-3 text-yellow-400 line-clamp-2">Eco-Friendly Spirulina Production</h3>
								<p class="text-sm text-white line-clamp-3">Learn about our sustainable farming practices and commitment to environmental conservation in spirulina cultivation.</p>
								<a href="#" class="inline-block mt-4 text-green-400 hover:text-green-300 font-semibold text-sm transition-colors">Read More →</a>
							</div>
						</div>
					</div>

					<!-- Blog Card 4 -->
					<div class="carousel-card min-w-full md:min-w-1/3 lg:min-w-1/4 px-3">
						<div class="bg-gray-800/50 backdrop-blur-sm border border-green-500/30 rounded-lg overflow-hidden hover:border-green-400/60 hover:bg-gray-800/70 transition-all duration-200 h-full">
							<div class="w-full h-48 bg-linear-to-br from-green-600 to-green-800 flex items-center justify-center overflow-hidden">
								<img src="https://picsum.photos/400/300?random=13" alt="Blog Post" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" />
							</div>
							<div class="p-6">
								<p class="text-xs text-green-400 font-semibold mb-2">RESEARCH</p>
								<h3 class="text-lg font-bold mb-3 text-yellow-400 line-clamp-2">Scientific Studies on Spirulina Benefits</h3>
								<p class="text-sm text-white line-clamp-3">Explore peer-reviewed research and scientific evidence supporting the health benefits of spirulina supplementation.</p>
								<a href="#" class="inline-block mt-4 text-green-400 hover:text-green-300 font-semibold text-sm transition-colors">Read More →</a>
							</div>
						</div>
					</div>

					<!-- Blog Card 5 -->
					<div class="carousel-card min-w-full md:min-w-1/3 lg:min-w-1/4 px-3">
						<div class="bg-gray-800/50 backdrop-blur-sm border border-green-500/30 rounded-lg overflow-hidden hover:border-green-400/60 hover:bg-gray-800/70 transition-all duration-200 h-full">
							<div class="w-full h-48 bg-linear-to-br from-green-600 to-green-800 flex items-center justify-center overflow-hidden">
								<img src="https://picsum.photos/400/300?random=14" alt="Blog Post" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" />
							</div>
							<div class="p-6">
								<p class="text-xs text-green-400 font-semibold mb-2">TESTIMONIALS</p>
								<h3 class="text-lg font-bold mb-3 text-yellow-400 line-clamp-2">Customer Success Stories with Spirulina</h3>
								<p class="text-sm text-white line-clamp-3">Real stories from our customers about their health transformation journey with our spirulina products.</p>
								<a href="#" class="inline-block mt-4 text-green-400 hover:text-green-300 font-semibold text-sm transition-colors">Read More →</a>
							</div>
						</div>
					</div>

					<!-- Blog Card 6 -->
					<div class="carousel-card min-w-full md:min-w-1/3 lg:min-w-1/4 px-3">
						<div class="bg-gray-800/50 backdrop-blur-sm border border-green-500/30 rounded-lg overflow-hidden hover:border-green-400/60 hover:bg-gray-800/70 transition-all duration-200 h-full">
							<div class="w-full h-48 bg-linear-to-br from-green-600 to-green-800 flex items-center justify-center overflow-hidden">
								<img src="https://picsum.photos/400/300?random=15" alt="Blog Post" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" />
							</div>
							<div class="p-6">
								<p class="text-xs text-green-400 font-semibold mb-2">RECIPES</p>
								<h3 class="text-lg font-bold mb-3 text-yellow-400 line-clamp-2">Delicious Spirulina Smoothie Recipes</h3>
								<p class="text-sm text-white line-clamp-3">Try our collection of tasty smoothie recipes packed with spirulina for a nutritious breakfast or snack.</p>
								<a href="#" class="inline-block mt-4 text-green-400 hover:text-green-300 font-semibold text-sm transition-colors">Read More →</a>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Navigation Controls -->
			<div class="flex items-center justify-between mt-8">
				<!-- Left Arrow -->
				<button id="prevBtn" class="flex items-center justify-center w-12 h-12 rounded-full bg-green-500 hover:bg-green-600 text-black font-bold transition-all duration-200 hover:shadow-lg hover:shadow-green-500/50 active:scale-95">
					<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
					</svg>
				</button>

				<!-- Indicators -->
				<div id="indicators" class="flex gap-2 justify-center flex-1 mx-4">
					<!-- Indicator dots will be generated by JavaScript -->
				</div>

				<!-- Right Arrow -->
				<button id="nextBtn" class="flex items-center justify-center w-12 h-12 rounded-full bg-green-500 hover:bg-green-600 text-black font-bold transition-all duration-200 hover:shadow-lg hover:shadow-green-500/50 active:scale-95">
					<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
					</svg>
				</button>
			</div>
		</div>
	</div>
</section>

<script>
	import { articleService } from '../services/articleService';
	import { UPLOADS_URL } from '../utils/api';

	const carousel = document.getElementById('carousel') as HTMLElement;
	const prevBtn = document.getElementById('prevBtn') as HTMLButtonElement;
	const nextBtn = document.getElementById('nextBtn') as HTMLButtonElement;
	const indicatorsContainer = document.getElementById('indicators') as HTMLElement;

	let currentIndex = 0;
	let autoplayInterval: ReturnType<typeof setInterval>;
	let totalCards = 0;
	const cardWidth = 100; // Each card is 100% width in the carousel
	const autoplayDelay = 5000; // Auto-rotate every 5 seconds

	// Load articles from backend
	async function loadArticles() {
		try {
			const response = await articleService.getAllArticles();
			
			if (response.success && response.data && response.data.length > 0) {
				// Filter published articles and take first 6
				const articles = response.data.filter((article: any) => article.is_published).slice(0, 6);
				
				if (articles.length > 0) {
					carousel.innerHTML = articles.map((article: any) => {
						const imageUrl = article.image_url ? `${UPLOADS_URL}/${article.image_url}` : 'https://picsum.photos/400/300?random=' + article.id;
						const excerpt = article.excerpt || (article.content ? article.content.substring(0, 120) + '...' : '');
						
						return `
							<div class="carousel-card min-w-full md:min-w-1/3 lg:min-w-1/4 px-3">
								<a href="/Article?id=${article.id}">
									<div class="bg-gray-800/50 backdrop-blur-sm border border-green-500/30 rounded-lg overflow-hidden hover:border-green-400/60 hover:bg-gray-800/70 transition-all duration-200 h-full">
										<div class="w-full h-48 bg-linear-to-br from-green-600 to-green-800 flex items-center justify-center overflow-hidden">
											<img src="${imageUrl}" alt="${article.title}" class="w-full h-full object-cover hover:scale-110 transition-transform duration-300" onerror="this.src='https://picsum.photos/400/300?random=${article.id}'" />
										</div>
										<div class="p-6">
											<p class="text-xs text-green-400 font-semibold mb-2">ARTICLE</p>
											<h3 class="text-lg font-bold mb-3 text-yellow-400 line-clamp-2">${article.title}</h3>
											<p class="text-sm text-white line-clamp-3">${excerpt}</p>
											<span class="inline-block mt-4 text-green-400 hover:text-green-300 font-semibold text-sm transition-colors">Read More →</span>
										</div>
									</div>
								</a>
							</div>
						`;
					}).join('');
					
					totalCards = articles.length;
					generateIndicators();
					startAutoplay();
					updateCarousel();
				}
			}
		} catch (error) {
			console.error('Error loading articles:', error);
		}
	}

	// Generate indicator dots
	function generateIndicators() {
		indicatorsContainer.innerHTML = '';
		for (let i = 0; i < totalCards; i++) {
			const dot = document.createElement('button');
			dot.className = `w-2 h-2 rounded-full transition-all duration-300 ${i === 0 ? 'bg-green-500 w-8' : 'bg-gray-600 hover:bg-gray-500'}`;
			dot.addEventListener('click', () => goToSlide(i));
			indicatorsContainer.appendChild(dot);
		}
	}

	// Update carousel position and indicators
	function updateCarousel() {
		const offset = -currentIndex * cardWidth;
		carousel.style.transform = `translateX(${offset}%)`;

		// Update indicator dots
		document.querySelectorAll('#indicators button').forEach((dot, index) => {
			if (index === currentIndex) {
				dot.classList.remove('w-2', 'bg-gray-600', 'hover:bg-gray-500');
				dot.classList.add('w-8', 'bg-green-500');
			} else {
				dot.classList.remove('w-8', 'bg-green-500');
				dot.classList.add('w-2', 'bg-gray-600', 'hover:bg-gray-500');
			}
		});

		// Restart autoplay
		resetAutoplay();
	}

	// Go to specific slide
	function goToSlide(index: number) {
		currentIndex = index % totalCards;
		updateCarousel();
	}

	// Next slide
	function nextSlide() {
		currentIndex = (currentIndex + 1) % totalCards;
		updateCarousel();
	}

	// Previous slide
	function prevSlide() {
		currentIndex = (currentIndex - 1 + totalCards) % totalCards;
		updateCarousel();
	}

	// Auto-play functionality
	function startAutoplay() {
		autoplayInterval = setInterval(nextSlide, autoplayDelay);
	}

	function resetAutoplay() {
		clearInterval(autoplayInterval);
		startAutoplay();
	}

	// Event listeners
	nextBtn.addEventListener('click', nextSlide);
	prevBtn.addEventListener('click', prevSlide);

	// Pause autoplay on hover
	carousel.addEventListener('mouseenter', () => clearInterval(autoplayInterval));
	carousel.addEventListener('mouseleave', startAutoplay);

	// Initialize
	loadArticles();
</script>

<style>
	#carousel {
		display: flex;
	}
</style>
